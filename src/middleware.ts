import { NextResponse } from "next/server";import type { NextRequest } from "next/server";import { canAccess } from "@/lib/rbac";function getUserRole(req:NextRequest){const role=req.cookies.get("spymeo_role")?.value as any;return role as ("ADMIN"|"PRACTITIONER"|"ARTISAN"|"COMMERCANT"|"PASS_USER"|"AMBASSADOR"|"PARTNER"|undefined);}export function middleware(req:NextRequest){const { pathname }=req.nextUrl;const role=getUserRole(req);const ok=canAccess(pathname,role);if(!ok)return NextResponse.redirect(new URL("/auth/login",req.url));return NextResponse.next();}export const config={matcher:["/pass/:path*","/pro/:path*","/admin/:path*"]};